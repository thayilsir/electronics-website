<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Electronics Pocket ‚Äî iOS-style</title>
<link rel="icon" href="data:,">
<style>
/* ======= iOS-like design tokens ======= */
:root{
  --accent: #0a84ff; /* iOS blue */
  --accent-2: #30d158; /* green */
  --bg-soft: linear-gradient(180deg, rgba(250,250,252,0.9), rgba(243,246,250,0.85));
  --card: rgba(255,255,255,0.65);
  --glass-border: rgba(255,255,255,0.6);
  --muted: #6b7280;
  --text: #0b1220;
  --radius-lg: 20px;
  --radius-md: 12px;
  --blur: 14px;
  --shadow-1: 0 10px 30px rgba(2,6,23,0.08);
  --transition: 350ms cubic-bezier(.2,.9,.2,1);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Dark theme tokens (applied via body[data-theme="dark"]) */
body[data-theme="dark"]{
  --card: rgba(18,18,20,0.6);
  --glass-border: rgba(255,255,255,0.06);
  --bg-soft: linear-gradient(180deg, #000000, #071021);
  --muted: #94a3b8;
  --text: #e6eef9;
  --shadow-1: 0 10px 30px rgba(2,6,23,0.5);
}

/* Global */
html,body{height:100%;margin:0;background:var(--bg-soft);color:var(--text);transition:background var(--transition), color var(--transition)}
*{box-sizing:border-box}
a{color:inherit}
.app{
  display:grid;
  grid-template-columns: 280px 1fr;
  gap:20px;
  height:100vh;
  padding:22px;
  align-items:start;
}

/* Sidebar (glass) */
.sidebar{
  position:relative;
  height:calc(100vh - 44px);
  border-radius:var(--radius-lg);
  background:var(--card);
  border:1px solid var(--glass-border);
  padding:16px;
  box-shadow:var(--shadow-1);
  backdrop-filter: blur(var(--blur)) saturate(120%);
  overflow:auto;
}
.brand{display:flex;gap:12px;align-items:center;margin-bottom:12px}
.logo{
  width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;
  background:linear-gradient(135deg,var(--accent), #7fd3ff);
  color:white; box-shadow:0 6px 18px rgba(10,20,40,0.12)
}
.site-title{font-size:16px;font-weight:700}
.site-sub{font-size:12px;color:var(--muted)}

/* Nav */
.nav{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.nav a{
  display:flex;gap:10px;align-items:center;padding:10px;border-radius:12px;text-decoration:none;color:var(--text);
  transition:transform var(--transition), background var(--transition);
}
.nav a:hover{transform:translateX(6px);background:rgba(10,10,10,0.03)}
.nav a.active{background:linear-gradient(90deg, rgba(10,10,10,0.04), rgba(255,255,255,0.02));box-shadow:inset 0 0 0 1px rgba(0,0,0,0.02)}

/* Controls */
.controls{margin-top:auto;display:flex;flex-direction:column;gap:8px}
.control-row{display:flex;gap:8px;align-items:center}
.btn{
  padding:8px 10px;border-radius:12px;border:0;background:transparent;cursor:pointer;
  font-weight:600;color:var(--text);
  transition:transform var(--transition), background var(--transition);
}
.btn:hover{transform:translateY(-2px);opacity:0.95}

/* Main content */
main{
  height:calc(100vh - 44px);
  overflow:auto;padding:22px;border-radius:var(--radius-lg);
  background:var(--card);border:1px solid var(--glass-border);
  box-shadow:var(--shadow-1);backdrop-filter: blur(var(--blur));
}

/* Header area */
.page-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
.search{display:flex;align-items:center;gap:10px}
.search input{
  padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,0.06);
  min-width:300px;background:transparent;color:inherit;transition:box-shadow var(--transition);
}
.search input:focus{box-shadow:0 6px 20px rgba(10,20,60,0.08);outline:none}

/* Section titles */
section h2{display:flex;align-items:center;gap:10px;margin:6px 0 12px 0;font-size:18px}

/* Cards grid */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px}

/* Card */
.card{
  border-radius:14px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
  border:1px solid var(--glass-border);transition:transform 220ms ease, box-shadow var(--transition);
}
body[data-theme="dark"] .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
.card:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(2,6,23,0.15)}

/* card header */
.card h3{display:flex;align-items:center;justify-content:space-between;gap:8px;margin:0}
.card .meta{font-size:13px;color:var(--muted);margin-top:8px}

/* Accordion expanded */
.expanded{
  margin-top:10px;border-radius:10px;padding:14px;background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.85));
  border:1px solid rgba(0,0,0,0.04);position:relative;animation:pop .18s ease;
}
body[data-theme="dark"] .expanded{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01))}
@keyframes pop{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
.close-x{position:absolute;right:12px;top:12px;background:transparent;border:0;font-size:18px;cursor:pointer}

/* Open button style */
.open-btn{padding:8px 10px;border-radius:10px;border:1px solid var(--glass-border);background:transparent;cursor:pointer}

/* Toggle style (iOS-like) */
.switch-wrap{display:flex;gap:8px;align-items:center}
.switch{
  width:46px;height:28px;border-radius:999px;background:rgba(0,0,0,0.08);position:relative;border:1px solid rgba(255,255,255,0.06);
  transition:background .25s ease;
}
.switch .knob{position:absolute;top:3px;left:3px;width:22px;height:22px;border-radius:50%;background:white;box-shadow:0 6px 14px rgba(2,6,23,0.15);transition:left .28s cubic-bezier(.2,.9,.2,1)}
.switch.on{background:linear-gradient(90deg,var(--accent), #60b8ff)}
.switch.on .knob{left:21px}

/* Responsive */
@media (max-width:920px){
  .app{grid-template-columns:1fr; padding:12px}
  .sidebar{position:relative;height:auto;width:100%;display:flex;flex-direction:row;gap:8px;overflow:auto;padding:10px}
  .nav{flex-direction:row}
  .search input{min-width:180px}
  main{height:auto}
}

/* Print rules */
@media print {
  .sidebar, .controls, input[type="search"], .nav { display:none !important; }
  main{box-shadow:none;border:none;background:white}
  .expanded{background:white}
}
</style>
</head>
<body data-theme="light">
<div class="app" id="app">
  <aside class="sidebar" aria-label="Main navigation">
    <div class="brand">
      <div class="logo" aria-hidden="true">‚ö°</div>
      <div>
        <div class="site-title">Electronics Pocket</div>
        <div class="site-sub">iOS-style, factual, slightly witty</div>
      </div>
    </div>

    <nav class="nav" id="nav">
      <a href="#components" data-target="components" class="nav-link">üîå Basic Components</a>
      <a href="#projects" data-target="projects" class="nav-link">üõ†Ô∏è Projects</a>
      <a href="#microcontrollers" data-target="microcontrollers" class="nav-link">üí° Microcontrollers</a>
      <a href="#interview" data-target="interview" class="nav-link">üéØ Interview Qs</a>
      <a href="#tips" data-target="tips" class="nav-link">üìö Tips</a>
    </nav>

    <div class="controls" role="region" aria-label="Sidebar controls">
      <div class="control-row">
        <div class="switch-wrap" title="Theme">
          <div id="themeSwitch" class="switch" role="switch" aria-checked="false" tabindex="0">
            <div class="knob" aria-hidden="true"></div>
          </div>
          <div class="muted small">Dark Mode</div>
        </div>
      </div>
      <div class="control-row">
        <button id="openAll" class="btn">üîé Expand first</button>
        <button id="collapseAll" class="btn">‚ùå Collapse all</button>
      </div>
      <div class="control-row">
        <button id="printBtn" class="btn">üñ®Ô∏è Print / Export</button>
      </div>
    </div>
  </aside>

  <main id="main" tabindex="0" role="main">
    <header class="page-header">
      <div>
        <h1 style="margin:0">Electronics Pocket</h1>
        <div class="muted small">iOS-feel UI ‚Ä¢ Dark mode tuned ‚Ä¢ Deep links ‚Ä¢ Search</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px">
        <div class="search" role="search">
          <input id="search" type="search" placeholder="Search components, projects, microcontrollers, questions..." aria-label="Search site" />
        </div>
        <button id="printNow" class="btn">Print view</button>
      </div>
    </header>
        <!-- COMPONENTS -->
    <section id="components" tabindex="-1">
      <h2>üîå Basic Electronic Components</h2>
      <div class="grid" id="componentsGrid" role="list">
        <!-- JS will inject 20+ component cards here -->
      </div>
    </section>
    <!-- PROJECTS -->
    <section id="projects" tabindex="-1">
      <h2>üõ†Ô∏è Electronics Projects (Beginner ‚Üí Intermediate)</h2>
      <div class="grid" id="projectsGrid" role="list">
        <!-- JS will inject 20+ project cards here -->
      </div>
    </section>
    <!-- MICROCONTROLLERS -->
    <section id="microcontrollers" tabindex="-1">
      <h2>üí° Microcontrollers & Dev Boards</h2>
      <div class="grid" id="microGrid" role="list">
        <!-- JS will inject 20+ microcontroller cards here -->
      </div>
    </section>

    <!-- INTERVIEW QUESTIONS -->
    <section id="interview" tabindex="-1">
      <h2>üéØ Electronics Engineering Interview Questions</h2>
      <div class="grid" id="interviewGrid" role="list">
        <!-- JS will inject 20+ interview cards here -->
      </div>
    </section>

    <section id="tips" tabindex="-1" style="margin-top:20px">
      <h2>üìö Quick Tips & Shortcuts</h2>
      <div class="card">
        <ul style="margin:0 0 0 18px;padding:6px 0;color:var(--muted)">
          <li><strong>Search:</strong> Filters instantly across titles & content.</li>
          <li><strong>Deep link:</strong> Open an item, copy URL (hash) to share directly.</li>
          <li><strong>Keyboard:</strong> Esc closes expanded content. Enter opens focused open buttons.</li>
          <li><strong>Print:</strong> Print/export respects collapsed state and focuses on content.</li>
        </ul>
      </div>
    </section>
  </main>
</div>
<script>
/* ============================
   DATA: components, projects, microcontrollers, interview
   Each array contains 20+ real, meaningful items.
   ============================ */

const components = [
  { id:"cmp-resistor", title:"Resistor", summary:"Limits current and sets voltages.", content:
    `<p><strong>What it is:</strong> Passive component measured in ohms (Œ©) that resists current.</p>
     <p><strong>How it works:</strong> Electric current colliding with atoms converts energy to heat ‚Äî Ohm's law V=IR describes behavior.</p>
     <p><strong>Typical uses:</strong> LED current limiting, voltage dividers, bias networks.</p>` },
  { id:"cmp-capacitor", title:"Capacitor", summary:"Stores electric energy in an electric field.", content:
    `<p><strong>What it is:</strong> Two conductive plates separated by dielectric storing charge.</p>
     <p><strong>How it works:</strong> Passes AC (impedance drops with frequency) but blocks DC after charge, useful in timing and filtering.</p>
     <p><strong>Typical uses:</strong> Power smoothing, coupling/decoupling, timing (RC).</p>` },
  { id:"cmp-inductor", title:"Inductor", summary:"Stores energy in a magnetic field.", content:
    `<p><strong>What it is:</strong> Coil of wire with inductance measured in henries (H).</p>
     <p><strong>How it works:</strong> Resists changes in current (V=L¬∑di/dt); used with capacitors to tune frequencies.</p>
     <p><strong>Typical uses:</strong> Power supply chokes, filters, converters, resonant circuits.</p>` },
  { id:"cmp-diode", title:"Diode", summary:"One-way current device.", content:
    `<p><strong>What it is:</strong> Semiconductor junction that conducts primarily in one direction.</p>
     <p><strong>How it works:</strong> Forward bias allows carrier flow; reverse bias blocks until breakdown.</p>
     <p><strong>Typical uses:</strong> Rectifiers, protection diodes, signal demodulation.</p>` },
  { id:"cmp-led", title:"LED", summary:"Diode that emits light.", content:
    `<p><strong>What it is:</strong> Light Emitting Diode ‚Äî emits photons when forward biased.</p>
     <p><strong>How it works:</strong> Electron-hole recombination across PN junction releases energy as light; color depends on bandgap.</p>
     <p><strong>Typical uses:</strong> Indicators, illumination, displays.</p>` },
  { id:"cmp-bjt", title:"BJT (Bipolar Junction Transistor)", summary:"Current-controlled transistor.", content:
    `<p><strong>What it is:</strong> Three-layer device (NPN/PNP) that amplifies current.</p>
     <p><strong>How it works:</strong> Small base current controls larger collector-emitter current; good for analog stages and switching.</p>
     <p><strong>Typical uses:</strong> Amplifiers, small-signal switching, drivers.</p>` },
  { id:"cmp-mosfet", title:"MOSFET", summary:"Voltage-controlled transistor, great for power.", content:
    `<p><strong>What it is:</strong> Field-Effect Transistor with gate controlling channel conductivity.</p>
     <p><strong>How it works:</strong> Gate voltage forms channel; Rds(on) and Vgs(th) are key specs.</p>
     <p><strong>Typical uses:</strong> Power switching, motor drivers, DC-DC converters.</p>` },
  { id:"cmp-opamp", title:"Op-Amp", summary:"Amplifier building block.", content:
    `<p><strong>What it is:</strong> High gain differential amplifier used in many analog circuits.</p>
     <p><strong>How it works:</strong> Differential input amplified; feedback defines closed-loop gain and behavior.</p>
     <p><strong>Typical uses:</strong> Filters, buffers, amplifiers, comparators.</p>` },
  { id:"cmp-ic", title:"Integrated Circuit (IC)", summary:"Multiple functions built into a chip.", content:
    `<p><strong>What it is:</strong> Packaged semiconductor containing many transistors and passive elements.</p>
     <p><strong>How it works:</strong> Fabrication integrates many components to perform computation, analog tasks or mixed-signal functions.</p>
     <p><strong>Typical uses:</strong> Logic gates, microcontrollers, op-amps, power management.</p>` },
  { id:"cmp-relay", title:"Relay", summary:"Electromechanical or solid-state switch.", content:
    `<p><strong>What it is:</strong> Uses electromagnetic coil to move contacts (mechanical) or electronic switching (SSR).</p>
     <p><strong>How it works:</strong> Coil energizes a mechanism to open/close circuit; isolates control and load circuits.</p>
     <p><strong>Typical uses:</strong> Isolated switching of high voltages/currents in automation and automotive.</p>` },
  { id:"cmp-switch", title:"Switch", summary:"Manual on/off control.", content:
    `<p><strong>What it is:</strong> Mechanical component that connects/disconnects a circuit.</p>
     <p><strong>How it works:</strong> Contacts close for conduction, open for isolation; comes in SPST, SPDT, DPDT etc.</p>
     <p><strong>Typical uses:</strong> Power toggles, mode selectors, user inputs.</p>` },
  { id:"cmp-pot", title:"Potentiometer", summary:"Adjustable resistor (knob control).", content:
    `<p><strong>What it is:</strong> A variable resistor with a wiper giving adjustable voltage division.</p>
     <p><strong>How it works:</strong> Sliding contact changes tap point along resistive element to vary output.</p>
     <p><strong>Typical uses:</strong> Volume controls, calibration, adjustable thresholds.</p>` },
  { id:"cmp-crystal", title:"Quartz Crystal / Oscillator", summary:"Precise timing reference.", content:
    `<p><strong>What it is:</strong> Piezoelectric quartz resonator used for stable frequency reference.</p>
     <p><strong>How it works:</strong> Mechanical resonance from quartz produces stable oscillation used in clocks and microcontrollers.</p>
     <p><strong>Typical uses:</strong> MCU clocks, RTC modules, communication carrier frequencies.</p>` },
  { id:"cmp-fuse", title:"Fuse", summary:"Overcurrent sacrificial protection.", content:
    `<p><strong>What it is:</strong> Element designed to melt under excessive current to interrupt circuit.</p>
     <p><strong>How it works:</strong> Thin conductor heats and melts at specified current/time to prevent damage/fire.</p>
     <p><strong>Typical uses:</strong> Power protection, replaceable safety devices.</p>` },
  { id:"cmp-transformer", title:"Transformer", summary:"Magnetic coupling between circuits.", content:
    `<p><strong>What it is:</strong> Two or more coils on a magnetic core transferring energy via flux.</p>
     <p><strong>How it works:</strong> Voltage ratio = turns ratio; used for stepping voltages up/down and isolation.</p>
     <p><strong>Typical uses:</strong> Power supplies, isolation, impedance matching.</p>` },
  { id:"cmp-temp-sensor", title:"Temperature Sensors (LM35, DS18B20)", summary:"Measure temperature with voltage or digital output.", content:
    `<p><strong>What it is:</strong> Devices that convert temperature to electrical signals (analog/digital).</p>
     <p><strong>How it works:</strong> LM35 outputs mV/¬∞C; DS18B20 uses digital 1-Wire comms with calibrated temp.</p>
     <p><strong>Typical uses:</strong> Thermostats, data logging, environmental control.</p>` },
  { id:"cmp-light-sensor", title:"Light Sensors (LDR, Photodiode)", summary:"Detect ambient light.", content:
    `<p><strong>What it is:</strong> Devices whose resistance or current changes with light intensity.</p>
     <p><strong>How it works:</strong> Photodiodes produce current; LDRs change resistance with illumination.</p>
     <p><strong>Typical uses:</strong> Automatic lighting, brightness control, sensors.</p>` },
  { id:"cmp-hall", title:"Hall Effect Sensor", summary:"Detect magnetic fields or rotation.", content:
    `<p><strong>What it is:</strong> Produces voltage proportional to magnetic field, used for contactless sensing.</p>
     <p><strong>How it works:</strong> Charges moving in a conductor experience lateral force under magnetic fields, creating Hall voltage.</p>
     <p><strong>Typical uses:</strong> Motor commutation, proximity, RPM sensing.</p>` },
  { id:"cmp-imu", title:"IMU (Accelerometer + Gyro)", summary:"Motion/orientation sensing (MEMS).", content:
    `<p><strong>What it is:</strong> Integrated sensors measuring acceleration and angular velocity, often with magnetometer.</p>
     <p><strong>How it works:</strong> MEMS structures detect inertial forces & produce electrical signals processed by firmware.</p>
     <p><strong>Typical uses:</strong> Drones, IMU-based stabilisation, mobile orientation.</p>` },
  { id:"cmp-connector", title:"Connectors & Headers", summary:"Make removable electrical connections.", content:
    `<p><strong>What it is:</strong> Physical interfaces for power and signal wiring (USB, JST, pin headers).</p>
     <p><strong>How it works:</strong> Contacts mate to provide conduction and mechanical retention; choices depend on current/robustness.</p>
     <p><strong>Typical uses:</strong> Boards-to-modules interconnect, power feed, sensor plugs.</p>` }
];

const projects = [
  { id:"proj-led-blink", title:"LED Blink (Beginner)", summary:"Basic digital output blinking.", content:
    `<p><strong>Description:</strong> Blink an LED at 1 Hz to learn MCU digital outputs.</p>
     <ol><li>Connect LED with 220Œ© resistor to pin and GND.</li><li>Set pin as OUTPUT and toggle HIGH/LOW with 500ms delay.</li><li>Upload and test.</li></ol>
     <p><strong>Parts:</strong> LED, 220Œ© resistor, microcontroller.</p>
     <p><strong>Why:</strong> Teaches I/O, timing, and wiring safety.</p>` },
  { id:"proj-lm35-logger", title:"Temperature Logger (LM35 + SD)", summary:"Log temps to SD card.", content:
    `<p><strong>Description:</strong> Sample LM35, compute ¬∞C, append to CSV on SD.</p>
     <ol><li>Wire LM35 to ADC.</li><li>Use SPI to write to SD module.</li><li>Write CSV lines periodically.</li></ol>
     <p><strong>Parts:</strong> LM35, SD module, MCU, microSD.</p>
     <p><strong>Why:</strong> Real-world data logging and ADC basics.</p>` },
  { id:"proj-obstacle-robot", title:"Obstacle-Avoiding Robot", summary:"Robot that senses and avoids obstacles.", content:
    `<p><strong>Description:</strong> Use ultrasonic sensor to detect obstacles and steer around them.</p>
     <ol><li>Build motorized chassis.</li><li>Use HC-SR04 to read distance.</li><li>Implement reactive turning logic.</li></ol>
     <p><strong>Parts:</strong> Motors, motor driver, HC-SR04, MCU, battery.</p>
     <p><strong>Why:</strong> Teaches feedback, actuation, and power systems.</p>` },
  { id:"proj-solar-tracker", title:"Solar Tracker (LDR)", summary:"Maximise panel exposure.", content:
    `<p><strong>Description:</strong> Two LDRs steer small panel toward brightest direction.</p>
     <ol><li>Mount sensors with divider.</li><li>Compare readings and move motor appropriately.</li><li>Add deadband to prevent jitter.</li></ol>
     <p><strong>Parts:</strong> LDRs, small motor, MCU, H-bridge.</p>
     <p><strong>Why:</strong> Simple analog sensing and control.</p>` },
  { id:"proj-thermostat", title:"Digital Thermostat (Relay)", summary:"Control temperature with hysteresis.", content:
    `<p><strong>Description:</strong> Read temp and drive relay with hysteresis to prevent short-cycling.</p>
     <ol><li>Read sensor, compare to setpoint, apply hysteresis.</li><li>Drive relay for heater/fan.</li><li>Provide UI for setpoint adjustment.</li></ol>
     <p><strong>Parts:</strong> Sensor, relay module, MCU, display.</p>
     <p><strong>Why:</strong> Practical embedded control and safety considerations.</p>` },
  { id:"proj-line-follower", title:"Line Follower Robot", summary:"Follow track using IR sensors.", content:
    `<p><strong>Description:</strong> Use array of IR reflectance sensors to follow black line with PID control.</p>
     <ol><li>Mount sensors at front.</li><li>Implement PID using sensor error to steer motors.</li><li>Tune gains for stable following.</li></ol>
     <p><strong>Parts:</strong> IR sensors, motors, driver, MCU.</p>
     <p><strong>Why:</strong> Teaches control theory and sensors.</p>` },
  { id:"proj-rgb-bluetooth", title:"Bluetooth RGB LED Controller", summary:"Phone control of LED colors.", content:
    `<p><strong>Description:</strong> Parse commands over Bluetooth and set PWM for RGB channels.</p>
     <ol><li>Use BLE or classic BT module; parse color values.</li><li>Drive MOSFETs or use addressable LEDs like WS2812.</li><li>Provide simple mobile UI.</li></ol>
     <p><strong>Parts:</strong> BT module or ESP32, LEDs, MOSFETs/resistors.</p>
     <p><strong>Why:</strong> Networking + PWM + UX basics.</p>` },
  { id:"proj-esp-wifi-sensor", title:"WiFi Sensor Node (ESP)", summary:"Publish sensor data to MQTT.", content:
    `<p><strong>Description:</strong> Read sensor and publish JSON to MQTT broker for dashboarding.</p>
     <ol><li>Connect sensor, implement WiFi and MQTT client.</li><li>Send periodic updates with proper reconnection logic.</li><li>Secure credentials and validate data.</li></ol>
     <p><strong>Parts:</strong> ESP32/ESP8266, sensor, power supply.</p>
     <p><strong>Why:</strong> Entry-level IoT with real-world reliability concerns.</p>` },
  { id:"proj-sound-meter", title:"Sound Level Meter", summary:"Estimate loudness using microphone + ADC.", content:
    `<p><strong>Description:</strong> Condition mic signal and estimate RMS or peak to show relative dB.</p>
     <ol><li>Amplify microphone with op-amp.</li><li>Sample with ADC and compute short-window RMS.</li><li>Display on bar or OLED.</li></ol>
     <p><strong>Parts:</strong> Mic, op-amp, MCU, display.</p>
     <p><strong>Why:</strong> Signal conditioning and DSP basics.</p>` },
  { id:"proj-digital-scale", title:"Digital Weight Scale", summary:"HX711 + Load cell measurement.", content:
    `<p><strong>Description:</strong> Use load cell amplifier to read weights with calibration.</p>
     <ol><li>Mount load cell and wire HX711.</li><li>Read value, calibrate using known weights.</li><li>Implement tare and smoothing.</li></ol>
     <p><strong>Parts:</strong> Load cell, HX711, MCU, display.</p>
     <p><strong>Why:</strong> Low-noise reading and calibration methods.</p>` },
  { id:"proj-rfid-lock", title:"RFID Door Lock", summary:"Access control using RFID tokens.", content:
    `<p><strong>Description:</strong> Read RFID tag, check database, and drive lock actuator if authorized.</p>
     <ol><li>Use RFID reader (MFRC522 or similar).</li><li>Store authorized IDs in EEPROM or server.</li><li>Drive solenoid/relay and add debounce/security.</li></ol>
     <p><strong>Parts:</strong> RFID module, MCU, relay/solenoid, power supply.</p>
     <p><strong>Why:</strong> Authentication basics and actuator control.</p>` },
  { id:"proj-esp-cam", title:"ESP32-CAM Snapshot Server", summary:"Low-cost camera server.", content:
    `<p><strong>Description:</strong> Host snapshots or low-res stream from ESP32-CAM over WiFi.</p>
     <ol><li>Configure firmware and WiFi.</li><li>Serve minimal web UI for snapshots.</li><li>Store to SD if needed and secure access.</li></ol>
     <p><strong>Parts:</strong> ESP32-CAM, microSD, stable 5V supply.</p>
     <p><strong>Why:</strong> Tiny edge-camera prototyping with security implications.</p>` },
  { id:"proj-morse", title:"Morse Code Transmitter", summary:"Encode text to audio/LED Morse.", content:
    `<p><strong>Description:</strong> Map text to dot/dash sequences and blink/beep accordingly.</p>
     <ol><li>Implement dictionary for Morse mapping.</li><li>Timing critical: dot, dash, intra-character spacing.</li><li>Provide serial input or key.</li></ol>
     <p><strong>Parts:</strong> MCU, LED or buzzer, optional button.</p>
     <p><strong>Why:</strong> Teaches timing and simple encodings.</p>` },
  { id:"proj-wireless-remote", title:"433MHz Remote Control", summary:"Simple RF remote using ASK/OOK modules.", content:
    `<p><strong>Description:</strong> Send short codes via 433MHz RX/TX pairs to control devices.</p>
     <ol><li>Use lightweight encoding libraries.</li><li>Implement checksum/repeats to improve reliability.</li><li>Pair with receiver MCU to act on commands.</li></ol>
     <p><strong>Parts:</strong> 433MHz modules, MCUs, antennas.</p>
     <p><strong>Why:</strong> Introduces wireless basics and reliability tradeoffs.</p>` },
  { id:"proj-psu-bench", title:"Bench Power Supply (Adjustable)", summary:"Variable lab power supply.", content:
    `<p><strong>Description:</strong> Build an adjustable bench supply with current limiting and display.</p>
     <ol><li>Use adjustable regulator (LM317 or switching regulator).</li><li>Add current sense and limit circuitry.</li><li>Provide voltage/current display and safe shutdown.</li></ol>
     <p><strong>Parts:</strong> Regulator, heatsink, current sense resistor, display.</p>
     <p><strong>Why:</strong> Teaches power management and thermal design.</p>` },
  { id:"proj-battery-management", title:"Battery Management System (BMS)", summary:"Protect Li-ion cells with balancing & protection.", content:
    `<p><strong>Description:</strong> Implement cell monitoring, balancing, and protection for small battery packs.</p>
     <ol><li>Monitor cell voltages and temperatures.</li><li>Use balancing resistors or active balancers.</li><li>Include overvoltage/undervoltage and overcurrent protection.</li></ol>
     <p><strong>Parts:</strong> Cell monitor IC, MOSFETs, sense resistors, connectors.</p>
     <p><strong>Why:</strong> Critical for safe battery-powered systems.</p>` },
  { id:"proj-plant-monitor", title:"IoT Plant Monitor", summary:"Soil moisture + temp + cloud logging.", content:
    `<p><strong>Description:</strong> Read moisture and temp and publish to an online dashboard.</p>
     <ol><li>Use moisture sensor and DHT/BME sensor.</li><li>Send data via WiFi to MQTT/HTTP endpoint.</li><li>Create dashboard with alerts.</li></ol>
     <p><strong>Parts:</strong> ESP32, sensors, battery or USB power.</p>
     <p><strong>Why:</strong> Practical IoT with real sensor calibration needs.</p>` },
  { id:"proj-ups-mini", title:"Mini UPS for Router", summary:"Short backup for small network devices.", content:
    `<p><strong>Description:</strong> Create backup power using battery + automatic switchover.</p>
     <ol><li>Use diode-OR or ideal diode controller to switch between supply and battery.</li><li>Include charging and battery protection.</li><li>Add low-battery shutdown for safety.</li></ol>
     <p><strong>Parts:</strong> Battery pack, ideal diode IC, charger, MOSFETs.</p>
     <p><strong>Why:</strong> Teaches practical power switching and reliability considerations.</p>` }
];

const microcontrollers = [
  { id:"mcu-arduino-uno", title:"Arduino Uno", summary:"ATmega328P; beginner-friendly.", content:
    `<p><strong>Features:</strong> 16MHz, 32KB flash. Lots of shields and libraries.</p>
     <p><strong>Use-cases:</strong> Prototyping, education, simple robotics.</p>
     <p><strong>Why care:</strong> Huge community and easy onboarding for hardware projects.</p>` },
  { id:"mcu-arduino-nano", title:"Arduino Nano", summary:"Compact Uno-compatible board.", content:
    `<p><strong>Features:</strong> Small form, breadboard friendly.</p>
     <p><strong>Use-cases:</strong> Embedded hobby projects where space is tight.</p>
     <p><strong>Why care:</strong> Uno power in a tiny footprint.</p>` },
  { id:"mcu-esp32", title:"ESP32", summary:"WiFi + Bluetooth, dual-core.", content:
    `<p><strong>Features:</strong> Dual-core Xtensa, WiFi, BLE, many IOs and peripherals.</p>
     <p><strong>Use-cases:</strong> IoT, audio streaming, web servers.</p>
     <p><strong>Why care:</strong> Powerful and affordable for connected devices.</p>` },
  { id:"mcu-esp8266", title:"ESP8266", summary:"Low-cost WiFi MCU.", content:
    `<p><strong>Features:</strong> WiFi stack built-in, limited RAM vs ESP32.</p>
     <p><strong>Use-cases:</strong> Simple sensors and WiFi endpoints.</p>
     <p><strong>Why care:</strong> Cheap way to add WiFi to projects.</p>` },
  { id:"mcu-pico", title:"Raspberry Pi Pico (RP2040)", summary:"Dual-core M0+, PIO.", content:
    `<p><strong>Features:</strong> RP2040 dual-core, PIO for custom peripherals.</p>
     <p><strong>Use-cases:</strong> Fast I/O, protocol emulation, education.</p>
     <p><strong>Why care:</strong> Powerful MCU for mid-level embedded tasks.</p>` },
  { id:"mcu-stm32", title:"STM32 Family", summary:"ARM Cortex-M for performance projects.", content:
    `<p><strong>Features:</strong> Many families (F0/F1/F3/F4/M7) with DMA, timers, ADCs.</p>
     <p><strong>Use-cases:</strong> Motor control, data acquisition, industrial apps.</p>
     <p><strong>Why care:</strong> Industry-grade performance and peripherals.</p>` },
  { id:"mcu-pic", title:"PIC (Microchip)", summary:"Wide MCU family (8/16/32-bit).", content:
    `<p><strong>Features:</strong> Varied options for low-power and embedded control.</p>
     <p><strong>Use-cases:</strong> Legacy consumer electronics and industrial appliances.</p>
     <p><strong>Why care:</strong> Many commercial products still use PICs; knowledge helps maintain legacy systems.</p>` },
  { id:"mcu-attiny", title:"ATtiny", summary:"Tiny AVR for minimal tasks.", content:
    `<p><strong>Features:</strong> Very small pin count and memory, ideal for single-purpose controllers.</p>
     <p><strong>Use-cases:</strong> Low-cost embedded tasks and tiny sensors.</p>
     <p><strong>Why care:</strong> Efficient design and BOM reduction.</p>` },
  { id:"mcu-teensy", title:"Teensy", summary:"Fast boards for audio & USB projects.", content:
    `<p><strong>Features:</strong> High clock, USB host/device capabilities, good audio libraries.</p>
     <p><strong>Use-cases:</strong> MIDI controllers, audio DSP, high-speed IO.</p>
     <p><strong>Why care:</strong> Hobbyists and pros use it for performance-focused prototypes.</p>` },
  { id:"mcu-mega", title:"Arduino Mega", summary:"Lots of IO and memory.", content:
    `<p><strong>Features:</strong> ATmega2560 with many UARTs and IO pins.</p>
     <p><strong>Use-cases:</strong> Large sensor arrays and robotics with many peripherals.</p>
     <p><strong>Why care:</strong> Avoids IO multiplexing headaches during prototyping.</p>` },
  { id:"mcu-adafruit-feather", title:"Adafruit Feather", summary:"Modular dev board family.", content:
    `<p><strong>Features:</strong> Many variants with built-in LiPo charging and 'wings' ecosystem.</p>
     <p><strong>Use-cases:</strong> Portable IoT with standard expansion.</p>
     <p><strong>Why care:</strong> Rapid BOM assembly for prototypes and small products.</p>` },
  { id:"mcu-nrf52", title:"nRF52 (Nordic)", summary:"BLE-focused low-power SoC.", content:
    `<p><strong>Features:</strong> Cortex-M, optimized BLE stacks, low power modes.</p>
     <p><strong>Use-cases:</strong> Wearables, beacons, battery-operated sensors.</p>
     <p><strong>Why care:</strong> BLE industry standard for low-power wireless products.</p>` },
  { id:"mcu-samd", title:"SAM D (Atmel/Microchip)", summary:"Cortex-M0+ for Arduino Zero class boards.", content:
    `<p><strong>Features:</strong> 32-bit performance, more memory and peripherals than AVR.</p>
     <p><strong>Use-cases:</strong> More advanced embedded projects requiring 32-bit features.</p>
     <p><strong>Why care:</strong> Smooth transition from 8-bit to 32-bit MCU development.</p>` },
  { id:"mcu-beaglebone", title:"BeagleBone Black (SBC)", summary:"Linux-capable single-board computer.", content:
    `<p><strong>Features:</strong> Runs Linux; PRUs for deterministic I/O.</p>
     <p><strong>Use-cases:</strong> Edge compute where realtime and OS-level tasks are needed.</p>
     <p><strong>Why care:</strong> Use when you need full OS features with low-level control.</p>` },
  { id:"mcu-rpi-zero", title:"Raspberry Pi Zero/Family (SBC)", summary:"Linux SBC for heavy-lift tasks.", content:
    `<p><strong>Features:</strong> Runs full Linux distribution with camera/USB support.</p>
     <p><strong>Use-cases:</strong> Cameras, AI at edge, web servers.</p>
     <p><strong>Why care:</strong> Use SBCs when MCU bandwidth is insufficient or you need networking stacks/filesystems.</p>` },
  { id:"mcu-riscv", title:"RISC-V MCUs", summary:"Open ISA microcontrollers emerging in ecosystem.", content:
    `<p><strong>Features:</strong> Open instruction set and growing ecosystem.</p>
     <p><strong>Use-cases:</strong> Cost-sensitive and open-software projects.</p>
     <p><strong>Why care:</strong> Avoid vendor lock-in and learn open toolchains.</p>` },
  { id:"mcu-rtl", title:"Realtek/Other WiFi SoCs", summary:"Budget WiFi SoCs used in many consumer devices.", content:
    `<p><strong>Features:</strong> Diverse vendor features; often used in low-cost mass-market devices.</p>
     <p><strong>Use-cases:</strong> Consumer IoT products where price matters.</p>
     <p><strong>Why care:</strong> Be wary of SDK quality & security when choosing them.</p>` },
  { id:"mcu-esp32-s2", title:"ESP32-S2", summary:"ESP variant with USB and improved security.", content:
    `<p><strong>Features:</strong> Single-core CPU, USB OTG on some modules, improved security features.</p>
     <p><strong>Use-cases:</strong> Secure IoT endpoints, USB peripherals.</p>
     <p><strong>Why care:</strong> Better security and USB support compared to original ESP32 in specific use cases.</p>` },
  { id:"mcu-rtl8720", title:"RTL8720 & WiFi SoCs", summary:"Common SoCs powering cheap WiFi boards.", content:
    `<p><strong>Features:</strong> Integrated WiFi and MCU functions for low-cost devices.</p>
     <p><strong>Use-cases:</strong> Cost-sensitive IoT endpoints.</p>
     <p><strong>Why care:</strong> Useful for high-volume cheap products with tradeoffs in tooling and security.</p>` }
];

const interview = [
  { id:"q-ohm", title:"What is Ohm's Law?", summary:"V = I¬∑R; foundational relation.", content:
    `<p><strong>Answer:</strong> Ohm's Law: V = I¬∑R. For example, 2A through 10Œ© gives 20V.</p>
     <p><strong>Relevance:</strong> Basic calculation for resistor selection and current limits.</p>
     <p><strong>Why know:</strong> Every practical circuit uses it when choosing resistors and verifying currents.</p>` },
  { id:"q-kirchhoff", title:"KCL and KVL", summary:"Sum of currents & voltages rules.", content:
    `<p><strong>Answer:</strong> KCL: sum currents at node = 0. KVL: sum voltages in loop = 0.</p>
     <p><strong>Relevance:</strong> Used in nodal and mesh circuit analysis.</p>
     <p><strong>Why know:</strong> Essential for analyzing multi-node circuits and validating simulations.</p>` },
  { id:"q-rc", title:"RC Time Constant", summary:"œÑ = R¬∑C ‚Äî charge/discharge speed.", content:
    `<p><strong>Answer:</strong> œÑ = R¬∑C. After ~5œÑ capacitor charges ~99%.</p>
     <p><strong>Relevance:</strong> Timing, filters, debouncing logic.</p>
     <p><strong>Why know:</strong> Quick mental estimate of analog response speed.</p>` },
  { id:"q-opamp", title:"Op-amp configs (inverting vs non-inverting)", summary:"Sign & gain differences.", content:
    `<p><strong>Answer:</strong> Inverting: gain = -Rf/Rin. Non-inverting: gain = 1+Rf/Rg.</p>
     <p><strong>Relevance:</strong> Design of amplifiers and signal conditioning.</p>
     <p><strong>Why know:</strong> Core analog building blocks in sensor front-ends.</p>` },
  { id:"q-transistor", title:"NPN vs PNP transistors", summary:"Carrier polarity & bias directions.", content:
    `<p><strong>Answer:</strong> NPN uses electrons; base must be more positive. PNP uses holes; base more negative.</p>
     <p><strong>Relevance:</strong> Correct polarity needed for switching circuits.</p>
     <p><strong>Why know:</strong> Prevents wiring mistakes and damage when designing drivers.</p>` },
  { id:"q-mosfet-params", title:"MOSFET: Rds(on), Vgs(th), SOA", summary:"Key power-switch specs.", content:
    `<p><strong>Answer:</strong> Rds(on) = on resistance. Vgs(th) = threshold. SOA = safe voltage/current limits.</p>
     <p><strong>Relevance:</strong> Choosing MOSFETs for power converters and motors.</p>
     <p><strong>Why know:</strong> Wrong MOSFET kills efficiency and may overheat the system.</p>` },
  { id:"q-filters", title:"Filter types (low/high/band-pass)", summary:"Which frequency content to keep.", content:
    `<p><strong>Answer:</strong> Low-pass keeps low freqs, high-pass keeps high, band-pass keeps a band.</p>
     <p><strong>Relevance:</strong> Audio, RF, sensor front-ends require filtering.</p>
     <p><strong>Why know:</strong> Essential for removing noise and extracting signals of interest.</p>` },
  { id:"q-pcb", title:"PCB layout basics", summary:"Keep power short, decouple, route carefully.", content:
    `<p><strong>Answer:</strong> Use short high-current traces, decouple near ICs, control return paths and avoid long loops.</p>
     <p><strong>Relevance:</strong> Prevents noise, EMI, and heat issues.</p>
     <p><strong>Why know:</strong> Many annoying bugs are layout-related ‚Äî this knowledge shortens debugging time.</p>` },
  { id:"q-grounding", title:"Star ground vs multipoint", summary:"Grounding strategies for noise control.", content:
    `<p><strong>Answer:</strong> Star connects returns to single point; multipoint used at high frequency to reduce loop areas.</p>
     <p><strong>Relevance:</strong> Analog and high-speed digital designs need correct grounding.</p>
     <p><strong>Why know:</strong> Proper grounding prevents hum, noise, and measurement errors.</p>` },
  { id:"q-psu", title:"Linear vs Switching PSUs", summary:"Tradeoffs of noise vs efficiency.", content:
    `<p><strong>Answer:</strong> Linear is low-noise but inefficient; switching is efficient but noisy and more complex.</p>
     <p><strong>Relevance:</strong> Choose based on noise sensitivity, heat, and efficiency needs.</p>
     <p><strong>Why know:</strong> PSU selection affects product reliability and performance.</p>` },
  { id:"q-aliasing", title:"Aliasing & anti-aliasing", summary:"Nyquist and anti-alias filters.", content:
    `<p><strong>Answer:</strong> Aliasing occurs when signal > fs/2; mitigate with low-pass filter or higher sampling rate.</p>
     <p><strong>Relevance:</strong> Important for ADC systems, audio capture, and sensor sampling.</p>
     <p><strong>Why know:</strong> Prevents wrong readings and system misbehavior when sampling signals.</p>` },
  { id:"q-hysteresis", title:"Hysteresis & Schmitt triggers", summary:"Avoids chattering and provides clean switching.", content:
    `<p><strong>Answer:</strong> Hysteresis uses two thresholds to prevent rapid toggling from small disturbances.</p>
     <p><strong>Relevance:</strong> Essential in comparators, thermostats, and debounce circuits.</p>
     <p><strong>Why know:</strong> Increases system stability and reduces wear on actuators.</p>` },
  { id:"q-esp-security", title:"IoT security basics", summary:"TLS, auth, updates.", content:
    `<p><strong>Answer:</strong> Use TLS, validate firmware updates, avoid default credentials, rotate keys.</p>
     <p><strong>Relevance:</strong> Unsecured devices are common attack vectors.</p>
     <p><strong>Why know:</strong> Security matters for deployed systems ‚Äî not optional for commercial projects.</p>` },
  { id:"q-sigint", title:"Signal Integrity basics", summary:"Reflections, terminations, crosstalk.", content:
    `<p><strong>Answer:</strong> At high speed treat traces as transmission lines; use controlled impedance and proper termination.</p>
     <p><strong>Relevance:</strong> High-speed buses and RF need SI attention.</p>
     <p><strong>Why know:</strong> Prevents data corruption and intermittent failures.</p>` },
  { id:"q-adc-dac", title:"ADC vs DAC and key specs", summary:"Resolution, sampling rate, ENOB.", content:
    `<p><strong>Answer:</strong> ADC converts analog to digital; DAC the opposite. Check resolution, sampling rate, and linearity.</p>
     <p><strong>Relevance:</strong> Measurement accuracy depends on these specs.</p>
     <p><strong>Why know:</strong> Matching spec to application avoids poor performance.</p>` },
  { id:"q-psd", title:"Power dissipation & current sense", summary:"Thermals and sensing.", content:
    `<p><strong>Answer:</strong> Power = V¬∑I or I^2¬∑R; sense current with low-value resistor or hall sensor.</p>
     <p><strong>Relevance:</strong> Protects circuits and manages heat.</p>
     <p><strong>Why know:</strong> Thermal runaway and overheating are common failure causes.</p>` },
  { id:"q-smt", title:"SMT vs Through-hole", summary:"Manufacturing and mechanical tradeoffs.", content:
    `<p><strong>Answer:</strong> SMT is automated and compact; through-hole is strong mechanically and easier for hobbyists.</p>
     <p><strong>Relevance:</strong> Choice impacts manufacturing, repairability, and strength.</p>
     <p><strong>Why know:</strong> BOM and production choices are practical engineering decisions.</p>` },
  { id:"q-debugging", title:"Debugging embedded systems", summary:"Use serial logs, oscilloscopes, logic analyzers.", content:
    `<p><strong>Answer:</strong> Start with simple telemetry and progress to logic analyzer and scope traces for timing issues.</p>
     <p><strong>Relevance:</strong> Most issues are timing/communication related.</p>
     <p><strong>Why know:</strong> Knowing the right tool shortens debugging from days to hours.</p>` },
  { id:"q-ema", title:"EMC/EMI basics", summary:"Shielding, filtering, and layout.", content:
    `<p><strong>Answer:</strong> Reduce emissions with filtering, proper PCB layout, and shielding. Avoid large loops and apply decoupling.</p>
     <p><strong>Relevance:</strong> Regulatory compliance and reliable operation in noisy environments.</p>
     <p><strong>Why know:</strong> Necessary to meet standards and avoid field failures.</p>` }
];

/* ============================
   Rendering & Behavior (re-usable)
   ============================ */

function createCard(item){
  const card = document.createElement('article');
  card.className = 'card';
  card.id = item.id + '-card';
  const h = document.createElement('h3');
  h.innerHTML = `<span>${item.title}</span> <button class="open-btn" data-id="${item.id}" aria-expanded="false">Open</button>`;
  card.appendChild(h);
  const meta = document.createElement('div');
  meta.className = 'meta';
  meta.textContent = item.summary || '';
  card.appendChild(meta);

  const exp = document.createElement('div');
  exp.className = 'expanded';
  exp.style.display = 'none';
  exp.setAttribute('aria-hidden','true');
  exp.tabIndex = -1;
  exp.innerHTML = item.content || '';
  const closeBtn = document.createElement('button');
  closeBtn.className = 'close-x';
  closeBtn.setAttribute('aria-label','Close');
  closeBtn.innerHTML = '‚úñ';
  closeBtn.addEventListener('click', ()=> closeExpanded(item.id));
  exp.prepend(closeBtn);
  card.appendChild(exp);

  h.querySelector('button.open-btn').addEventListener('click', (e)=>{
    e.preventDefault();
    toggleExpanded(item.id);
  });

  // allow deep anchor in page
  const anchor = document.createElement('a');
  anchor.href = '#' + item.id;
  anchor.style.cssText = 'position:absolute;left:-9999px';
  card.appendChild(anchor);

  return card;
}

function renderList(list, containerId){
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  list.forEach(it => container.appendChild(createCard(it)));
}

/* initial renders */
renderList(components, 'componentsGrid');
renderList(projects, 'projectsGrid');
renderList(microcontrollers, 'microGrid');
renderList(interview, 'interviewGrid');

/* Expand/Collapse logic with deep-linking */
function toggleExpanded(id){
  const card = document.getElementById(id + '-card');
  if(!card) return;
  const exp = card.querySelector('.expanded');
  const btn = card.querySelector('.open-btn');
  const isOpen = exp.style.display !== 'none';
  if(isOpen){
    closeExpanded(id);
    history.replaceState(null,'', window.location.pathname + window.location.search);
  } else {
    openExpanded(id);
    history.replaceState(null,'', '#' + id);
  }
}
function openExpanded(id){
  document.querySelectorAll('.card .expanded').forEach(el=>{
    el.style.display = 'none';
    el.setAttribute('aria-hidden','true');
    const b = el.parentElement.querySelector('.open-btn'); if(b) b.setAttribute('aria-expanded','false');
  });
  const card = document.getElementById(id + '-card'); if(!card) return;
  const exp = card.querySelector('.expanded'); const btn = card.querySelector('.open-btn');
  exp.style.display = 'block'; exp.setAttribute('aria-hidden','false'); btn.setAttribute('aria-expanded','true');
  exp.focus();
  setTimeout(()=> card.scrollIntoView({behavior:'smooth', block:'center'}), 100);
}
function closeExpanded(id){
  const card = document.getElementById(id + '-card'); if(!card) return;
  const exp = card.querySelector('.expanded'); const btn = card.querySelector('.open-btn');
  exp.style.display = 'none'; exp.setAttribute('aria-hidden','true'); if(btn) btn.setAttribute('aria-expanded','false');
}

/* handle hash linking on load */
function handleHash(){
  const h = location.hash.replace('#','');
  if(!h) return;
  const possible = document.getElementById(h + '-card');
  if(possible){ openExpanded(h); }
  else {
    const s = document.getElementById(h);
    if(s) s.scrollIntoView({behavior:'smooth', block:'start'});
  }
}
window.addEventListener('hashchange', handleHash);
window.addEventListener('load', handleHash);

/* Search across all sections */
const searchInput = document.getElementById('search');
searchInput.addEventListener('input', (e) => filterAll(e.target.value.trim().toLowerCase()));

function filterAll(q){
  const all = document.querySelectorAll('.grid .card');
  all.forEach(card=>{
    const title = card.querySelector('h3 span').textContent.toLowerCase();
    const meta = card.querySelector('.meta')?.textContent.toLowerCase() || '';
    const content = card.querySelector('.expanded')?.textContent.toLowerCase() || '';
    const match = !q || title.includes(q) || meta.includes(q) || content.includes(q);
    card.style.display = match ? '' : 'none';
  });
}

/* Sidebar nav active highlight on scroll */
const navLinks = document.querySelectorAll('.nav-link');
const sections = Array.from(document.querySelectorAll('main section'));
function onScroll(){
  const top = window.scrollY + 140;
  let current = sections[0];
  for(const s of sections) if(s.offsetTop <= top) current = s;
  navLinks.forEach(a => a.classList.toggle('active', a.dataset.target === current.id));
}
document.addEventListener('scroll', onScroll, {passive:true});
onScroll();

/* Print */
document.getElementById('printNow').addEventListener('click', ()=> window.print());
document.getElementById('printBtn').addEventListener('click', ()=> window.print());

/* Open/collapse first */
document.getElementById('openAll').addEventListener('click', ()=>{
  ['componentsGrid','projectsGrid','microGrid','interviewGrid'].forEach(id=>{
    const first = document.getElementById(id)?.querySelector('.card');
    if(first){ openExpanded(first.id.replace('-card','')); }
  });
});
document.getElementById('collapseAll').addEventListener('click', ()=>{
  document.querySelectorAll('.card .expanded').forEach(el => el.style.display = 'none');
  history.replaceState(null,'', window.location.pathname + window.location.search);
});

/* Keyboard: Esc closes */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape'){
    document.querySelectorAll('.card .expanded').forEach(el => el.style.display='none');
    history.replaceState(null,'', window.location.pathname + window.location.search);
  }
});

/* Accessibility: Enter opens focused open-btn */
document.addEventListener('keyup', (e)=>{
  if(e.key === 'Enter' && document.activeElement && document.activeElement.classList.contains('open-btn')){
    document.activeElement.click();
  }
});

/* Theme switch (iOS-style) */
const themeSwitch = document.getElementById('themeSwitch');
function applyTheme(t){
  document.body.setAttribute('data-theme', t);
  // update visual switch
  if(t === 'dark'){ themeSwitch.classList.add('on'); themeSwitch.setAttribute('aria-checked','true'); }
  else { themeSwitch.classList.remove('on'); themeSwitch.setAttribute('aria-checked','false'); }
}
themeSwitch.addEventListener('click', ()=>{
  const cur = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  applyTheme(cur);
  localStorage.setItem('ep-theme', cur);
});
themeSwitch.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' ') themeSwitch.click(); });

/* initialize theme from localStorage */
const saved = localStorage.getItem('ep-theme') || 'light';
applyTheme(saved);

/* Make nav links smooth scroll */
document.querySelectorAll('.nav-link').forEach(link=>{
  link.addEventListener('click', (ev)=>{
    ev.preventDefault();
    const tgt = link.getAttribute('href').replace('#','');
    const el = document.getElementById(tgt);
    if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
    navLinks.forEach(a => a.classList.remove('active'));
    link.classList.add('active');
  });
});

/* small console note */
console.info('Electronics Pocket (iOS-style) loaded ‚Äî enjoy the view and get hands-on.');
</script>
</body>
</html>

